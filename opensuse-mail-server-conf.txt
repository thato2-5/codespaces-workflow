1. Update Your System
Before you start, make sure your system is up-to-date:
    sudo zypper refresh
    sudo zypper update

2. Install Mail Server Software
You'll need to install and configure several components:

Postfix (SMTP Server)
Postfix is a popular Mail Transfer Agent (MTA) for sending and receiving emails.
    sudo zypper install postfix

Dovecot (IMAP/POP3 Server)
Dovecot is used for retrieving and storing emails.
    sudo zypper install dovecot

SpamAssassin (Spam Filtering)
SpamAssassin helps in filtering spam.
    sudo zypper install spamassassin

ClamAV (Antivirus)
ClamAV is used for scanning emails for viruses.
    sudo zypper install clamav

3. Configure Postfix
Edit the Postfix configuration file:
    sudo nano /etc/postfix/main.cf

Update or add the following parameters:
# Basic settings
myhostname = mail.yourdomain.com
mydomain = yourdomain.com
myorigin = $mydomain
inet_interfaces = all
inet_protocols = ipv4

# Configure mailbox
home_mailbox = Maildir/

# Configure recipient restrictions
smtpd_recipient_restrictions = permit_mynetworks, permit_sasl_authenticated, reject_unauth_destination

# Configure TLS
smtpd_use_tls = yes
smtpd_tls_security_level = may
smtpd_tls_cert_file = /etc/ssl/certs/ssl-cert-snakeoil.pem
smtpd_tls_key_file = /etc/ssl/private/ssl-cert-snakeoil.key

Save and exit the file, then restart Postfix:
    sudo systemctl restart postfix

4. Configure Dovecot
Edit the Dovecot configuration file:
    sudo nano /etc/dovecot/dovecot.conf

Update or add the following parameters:
    # Enable maildir format
mail_location = maildir:~/Maildir

# Enable IMAP and POP3
protocols = imap pop3

Ensure the Dovecot service is running:
sudo systemctl enable dovecot
sudo systemctl start dovecot

5. Configure SpamAssassin
Edit the SpamAssassin configuration file:
    sudo nano /etc/sysconfig/spamassassin

Make sure the following options are set:
    STARTSPAMASSASSIN="yes"
CRON_DAILY="yes"

Restart the SpamAssassin service:
    sudo systemctl enable spamassassin
sudo systemctl start spamassassin

6. Configure ClamAV
Edit the ClamAV configuration file:
    sudo nano /etc/clamav/freshclam.conf

Make sure the following line is uncommented:
    DatabaseMirror db.local.clamav.net

Update the ClamAV database:
    sudo freshclam

Ensure ClamAV is running:
    sudo systemctl enable clamd@scan
sudo systemctl start clamd@scan

7. Configure Firewall
If you’re using firewalld, you’ll need to open the necessary ports:
    sudo firewall-cmd --permanent --add-service=smtp
sudo firewall-cmd --permanent --add-service=imap
sudo firewall-cmd --permanent --add-service=pop3
sudo firewall-cmd --reload
